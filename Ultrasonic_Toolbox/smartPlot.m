function [pntx,pnty,indx]=smartPlot(x,y,sym,txt)% Function for plotting with cursor control% Usage: [xmark,ymark,index]=plotx(x,y,symbol)% where [xmark,ymark] is an array of hand entered x,y points%       index is the set of indices for the last version of the plot%       x,y are points to plot%       symbol is the plotting symbol (default is connected line)% 1) press "t" in two locations to truncate outside the included range% 2) center mouse in area of interest and press "z" for zoom to zoom in% 3) press "f" to scroll forward & "b" for backwards by 10%% 4) press "a" to see whole plot again% 5) click mouse to enter point at cursor position.% 6) press "d" to delete entered point nearest cursor% 7) press <CR> to stop%   This function is designed to handle standard % data analysis, ie., plot data, select a range of% interest, zoom in on the important region, and mark% points for additional analysis (for example: identify % first breaks of signal or mark background levels for removal) % Set up initial values:if nargin==2, sym='-'; endnpts=length(x);if nargin~=4, txt=' '; endif nargin==3,  if (length(sym)<=2),    txt=' ';    else,     txt=sym;     sym='-';  endend% text plotting point: xplt=.15; yplt=.95;pntx=[];pnty=[];tot=1:npts;indx=tot;button(1)=1;%initial plot:plot(x,y,sym)text(xplt,yplt,txt,'sc')     if length(pntx)~=0,        hold on        plot(pntx,pnty,'o');        hold off     end     % Continue until you type "CR" while button(1)~=13,%	 [xx(1),yy(1),button]=ginput(1);%and here comes the fix for version 5.2[xxx,yyy,button]=ginput(1);if(isempty(button)==1)	button=13;else,	xx(1)=xxx; yy(1)=yyy;end% If "a" is typed then plot all   if button==97,     indx=tot;     plot(x(indx),y(indx),sym)      text(xplt,yplt,txt,'sc')     if length(pntx)~=0,        hold on        plot(pntx,pnty,'o');        hold off      end         end% Typing "t" in two locations truncates data outside those points    if button==116,           [xx(2),yy(2)]=ginput(1);          indx=find(x>xx(1) & x<xx(2));          plot(x(indx),y(indx),sym)          text(xplt,yplt,txt,'sc')          if length(pntx)~=0,            hold on            plot(pntx,pnty,'o');            hold off            end              end% letter "z" to zoom    if button==122,           test=abs(x-xx(1));           pnt=find(test==min(test));           npt=length(indx);           indx=(pnt-fix(npt/4)):(pnt+fix(npt/4));           indx=indx(find(indx<=npts) & indx>=1);           if(length(indx)<=1), indx=pnt-1:pnt+1; end           plot(x(indx),y(indx),sym)           text(xplt,yplt,txt,'sc')           if length(pntx)~=0,               hold on               plot(pntx,pnty,'o');               hold off               end           end% letter f to scroll forward  10%  if button==102,     pts=length(indx);     indx=indx+fix(pts/10);     indx=indx(find(indx<=npts) );     plot(x(indx),y(indx),sym)     text(xplt,yplt,txt,'sc')     if length(pntx)~=0,         hold on         plot(pntx,pnty,'o');         hold off         end     end% letter b to scroll back 10%  if button==98,     pts=length(indx);     indx=indx-fix(pts/10);     indx=indx(find(indx>=1) );     plot(x(indx),y(indx),sym)     text(xplt,yplt,txt,'sc')     if length(pntx)~=0,        hold on        plot(pntx,pnty,'o');        hold off        end     end% Click mouse to enter a point   if button==1,        pntx=[pntx xx(1)];        pnty=[pnty yy(1)];        hold on        plot(xx(1),yy(1),'o')        hold off        end% Type letter "d" to delete point   if button==100,       test=abs(pntx-xx(1));       pnt=find(test==min(test));       notpnt=find((1:length(pntx))~=pnt);       pnty=pnty(notpnt);       pntx=pntx(notpnt);       plot(x(indx),y(indx),sym)       text(xplt,yplt,txt,'sc')       hold on       plot(pntx,pnty,'o')       hold off       end  end